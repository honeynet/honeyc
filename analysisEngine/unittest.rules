alert tcp !$HOME_NET !80:443 -> $EXTERNAL_NET $HTTP_PORTS (msg: "rule1 msg"; reference:url,http://someref1.com; reference:url,http://someotherref2.com; sid: 1000001; rev:4; classtype:trojan-activity; priority:10; flowbits:noalert; flowbits:set,test; content:!"a \"string"; nocase; depth:3; within:4; headercontent: "text/html"; uricontent: "uri content string"; rawbytes; distance:10; offset:3; uricontent: "another uri content string"; isdataat:50,relative; nocase; content: "another string"; flow: to_server,established; pcre: !"/rule1pcre/i"; byte_test: 4,>,1000,20,relative; pcre: "/rule1pcre2/i"; )
#alert tcp any any <> any any (msg: "rule3 msg"; reference:url,http://rule3.com; sid:1000003; flow: to_client,established; rev:1; uricontent:"uricontentA"; nocase; content:"contentA"; classtype:trojan-activity; content:"contentB"; nocase; pcre:"/rule3pcre/"; )
alert tcp any any <> any any (msg: "rule2 msg"; reference:url,http://rule2.com; sid:1000002; rev:2; classtype:attempted-dos; pcre:"/rule2pcre/"; )
alert tcp any any <> any any (msg: "rule4 msg"; reference:url,http://rule4.com; sid:1000004; rev:2; classtype:attempted-dos; pcre:"/rule4pcre/"; uricontent:"uricontentA"; nocase; test_tag:unknown tag; uricontent:"uricontentB"; nocase; )
alert tcp any any <> any 22 (msg: "rule5 msg"; reference:url,http://rule5.com; sid:1000005; rev:2; classtype:attempted-dos; pcre:"/rule4pcre/"; uricontent:"uricontentA"; nocase; uricontent:"uricontentB"; nocase; ) #not relevant
